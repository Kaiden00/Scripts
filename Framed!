
if not game:IsLoaded() then game.Loaded:Wait() end

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local Client = Players.LocalPlayer
local GetTargetFunction = workspace.Events.GetTargetLocal

local TargetPlayer = nil

local ESPFolder = Instance.new("Folder")
ESPFolder.Name = "ESPFolder"
ESPFolder.Parent = game:GetService("CoreGui")

local BillboardGui = Instance.new("BillboardGui")
local TextLabel = Instance.new("TextLabel")

BillboardGui.Size = UDim2.new(0, 100, 0, 150)
BillboardGui.StudsOffset = Vector3.new(0, 1, 0)
BillboardGui.AlwaysOnTop = true
BillboardGui.Parent = ESPFolder

TextLabel.BackgroundTransparency = 1
TextLabel.Position = UDim2.new(0, 0, 0, -50)
TextLabel.Size = UDim2.new(0, 100, 0, 100)
TextLabel.Font = Enum.Font.SourceSansSemibold
TextLabel.TextSize = 20
TextLabel.TextColor3 = Color3.new(1, 1, 1)
TextLabel.TextStrokeTransparency = 0
TextLabel.TextYAlignment = Enum.TextYAlignment.Bottom
TextLabel.ZIndex = 10
TextLabel.Parent = BillboardGui

local function ESP()
    if tostring(Client.Team) == "Lobby" then return end
    if tostring(Client.Team) == "Police" then return end

    local PlayerTeam = TargetPlayer and tostring(TargetPlayer.Team)
    
    if not TargetPlayer or not TargetPlayer.Parent or PlayerTeam and PlayerTeam == "Lobby" then 
        TargetPlayer = GetTargetFunction:InvokeServer(Client)
        if not TargetPlayer then return end
        
        TextLabel.Text = "TARGET: "..TargetPlayer.Name
        BillboardGui.Name = TargetPlayer.Name
        BillboardGui.Adornee = TargetPlayer.Character.Head
    end
end

RunService.Heartbeat:Connect(ESP)

warn("Loaded")
